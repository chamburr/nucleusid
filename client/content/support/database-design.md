---
title: Database design
description: The database design, diagram and some explanations.
---

Here is an overview of the database design in ER diagram.

<img src="https://user-images.githubusercontent.com/42373024/194285481-f3a38499-5018-40ae-adde-47edbd094b7f.png" alt="Diagram" width="100%">
<br><br>

## Diesel schema migrations

This table is generated by Diesel. It takes care of database migrations, but you should just ignore
this table. Sorry, I placed it in the ER diagram just to fill up the empty space.

## Person

A person is just a user, but instead a fancy noun, or rather PostgreSQL doesn't like user as the
table name.

Password refers to a salted and hashed password. Verified refers to whether the user's email is
verified. Updated at refers to when the password was last changed, and not when other columns are
changed.

Public key and secret are related to the encryption, which is explained in detail in another
article.

## Folder

Every person has a default folder, specified by built in, which cannot be shared or deleted. Other
folders created in future can be shared.

## Account

An account belongs to a folder. Password is encrypted, while the other elements are simply stored in
plain text.

## Share

This contains the persons which a folder is shared with.

If a table is shared, there should minimally be one entry in this table. That is the owner of the
folder. It is needed in order to store the owner's secret for this folder.

When a share is created, it is not confirmed until the person confirms it on the dashboard. Before
confirmation, the person cannot view the folder. Created at is necessary because there is no
snowflake ID for this table, and we need to take care of expiry if the user does not confirm the
share.

---

## Footnote

I do realise that certain columns are not necessary. This includes person in account, sharing in
folder and owner in share. They are here for the purpose of convenience and fewer database queries.
